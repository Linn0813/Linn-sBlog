---
title: ğŸ› ï¸ 8/15ï½œAgent å·¥å…·ç³»ç»Ÿï¼šFunction Calling ä¸å¤–éƒ¨ä¸–ç•Œè¿æ¥
date: 2025-12-07 18:00:00
series: LLM/Agentç³»åˆ—æ•™ç¨‹
categories:
  - æŠ€æœ¯å­¦ä¹ ä¸è¡Œä¸šè¶‹åŠ¿
  - AIä¸ç ”ç©¶
tags:
  - LLM
  - Agent
  - Function Calling
  - Tools
  - å·¥å…·ç³»ç»Ÿ
  - Executor
keywords: LLM, Agent, Function Calling, Tools, å·¥å…·ç³»ç»Ÿ, Tool Schema, Executor, å·¥å…·å°è£…, æƒé™æ²»ç†
description: 'æ·±å…¥è§£æ Agent å·¥å…·ç³»ç»Ÿï¼šä» Function Calling æœºåˆ¶ã€å·¥å…·å°è£…è§„èŒƒåŒ–è®¾è®¡åˆ°å®‰å…¨æƒé™æ²»ç†ï¼Œè®© Agent æ‹¥æœ‰è¿æ¥å¤–éƒ¨ä¸–ç•Œçš„èƒ½åŠ›'
top_img: /img/llm-agent-tool-system.png
cover: /img/llm-agent-tool-system.png
comments: true
toc: true
toc_number: true
toc_style_simple: false
copyright: true
copyright_author: yuxiaoling
copyright_info: ç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
mathjax: false
katex: false
aplayer: false
highlight_shrink: false
aside: true
noticeOutdate: false
---

> **è¿™æ˜¯ã€ŠLLM/Agent æ ¸å¿ƒçŸ¥è¯†ä½“ç³»ã€‹ç³»åˆ—ç¬¬ 8 ç¯‡**

> ä¸Šä¸€ç¯‡æˆ‘ä»¬æ·±å…¥è§£æäº† Agent çš„è®°å¿†ç®¡ç†ï¼Œæ¢è®¨äº†å¦‚ä½•çªç ´ Context Window é™åˆ¶ï¼Œå®ç°é•¿æœŸä¸”è¿è´¯çš„è®°å¿†ç³»ç»Ÿã€‚

> æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†èšç„¦ Agent çš„å·¥å…·ç³»ç»Ÿï¼Œè§£æ Function Calling æœºåˆ¶ä¸å·¥å…·æ ‡å‡†åŒ–è®¾è®¡ï¼Œè®© Agent æ‹¥æœ‰è¿æ¥å¤–éƒ¨ä¸–ç•Œçš„èƒ½åŠ›ã€‚

---

## ğŸš€ å¯¼è¨€ â€” è®© Agent æ‹¥æœ‰"æ‰‹è„š"

Agent çš„æ ¸å¿ƒæ˜¯ **ReAct å¾ªç¯**ï¼Œå…¶ä¸­ **Actionï¼ˆè¡ŒåŠ¨ï¼‰**ç¯èŠ‚å¿…é¡»ä¾èµ–å¤–éƒ¨å·¥å…·æ‰èƒ½æ‰§è¡Œã€‚å·¥å…·æ˜¯ Agent ä¸ç°å®ä¸–ç•Œçš„å”¯ä¸€é€šé“ï¼Œèµ‹äºˆå®ƒæœç´¢ã€è®¡ç®—ã€æ“ä½œæ•°æ®åº“ã€å‘é€é‚®ä»¶ç­‰å®é™…èƒ½åŠ›ã€‚

æœ¬ç¯‡å°†æ·±å…¥è§£æ Agent å·¥å…·ç³»ç»Ÿæ ¸å¿ƒæœºåˆ¶ï¼š**Function Calling**ï¼Œå±•ç¤ºå¦‚ä½•å°†ä»»æ„å¤–éƒ¨ API æˆ–ä»£ç å°è£…æˆå¯è¢« LLM è°ƒç”¨çš„å·¥å…·ï¼Œå¹¶è®¨è®ºå·¥å…·çš„è§„èŒƒåŒ–è®¾è®¡ã€å®‰å…¨è¾¹ç•Œä¸å·¥ç¨‹å®è·µã€‚

---

## ä¸€ã€Function Calling çš„æœºåˆ¶æœ¬è´¨

Function Calling æ˜¯ LLM æä¾›çš„ä¸€ç§é«˜çº§èƒ½åŠ›ï¼Œå°†è‡ªç”±æ–‡æœ¬è¾“å‡ºè½¬åŒ–ä¸º **ç»“æ„åŒ–å‡½æ•°è°ƒç”¨å¯¹è±¡**ï¼Œä½¿ LLM èƒ½å¤Ÿå®‰å…¨ã€å¯æ§åœ°è°ƒç”¨å¤–éƒ¨å·¥å…·ã€‚

### 1.1 æ ¸å¿ƒæµç¨‹ï¼šSchema â†’ JSON â†’ æ‰§è¡Œ

1. **Tool Schema æ³¨å…¥ï¼ˆå®šä¹‰ï¼‰**

   * å¼€å‘è€…å°†å¯ç”¨å·¥å…·è§„èŒƒæè¿°æ³¨å…¥ LLMï¼ˆé€šå¸¸ä¸º JSON Schemaï¼‰

   * åŒ…å«å·¥å…·åã€åŠŸèƒ½æè¿°ã€å‚æ•°åŠç±»å‹

2. **LLM æ¨ç†ï¼ˆå†³ç­–ï¼‰**

   * LLM æ¥æ”¶åˆ°ç”¨æˆ·æŒ‡ä»¤å’Œå·¥å…· Schema

   * åœ¨ ReAct å¾ªç¯ä¸­åˆ¤æ–­æ˜¯å¦è°ƒç”¨å·¥å…·

   * ç”Ÿæˆç¬¦åˆ Schema çš„ **Action Call JSON å¯¹è±¡**

3. **Executor æ‰§è¡Œï¼ˆè¡ŒåŠ¨ï¼‰**

   * è§£æ JSONï¼Œè°ƒç”¨çœŸå®å‡½æ•°

   * æ‰§è¡Œç»“æœè¿”å›ç»™ LLM ä½œä¸º **Observation**

### 1.2 Function Calling çš„ä¼˜åŠ¿

* **é«˜ç¨³å®šæ€§ï¼š** æ¨¡å‹åº•å±‚ä¼˜åŒ–è¾“å‡º JSONï¼Œè§£ææˆåŠŸç‡é«˜

* **å‡å°‘æ­§ä¹‰ï¼š** LLM ä»…å¯é€‰æ‹©é¢„å®šä¹‰å·¥å…·ï¼Œå‚æ•°æ˜ç¡®

* **å®‰å…¨æ€§ï¼š** LLM è¾“å‡ºçš„æ˜¯ JSONï¼Œè€Œéç›´æ¥ä»£ç ï¼Œç¡®ä¿æ‰§è¡Œç¯å¢ƒå—æ§

> **ğŸ’¡ åè¯å¡ç‰‡**

>

> * **Tool Schemaï¼š** ä½¿ç”¨ JSON Schema å®šä¹‰çš„å·¥å…·è“å›¾

> * **Function Callingï¼š** ç»“æ„åŒ– JSON è¾“å‡ºï¼ŒæŒ‡ç¤ºå‡½æ•°è°ƒç”¨

> * **Executorï¼š** è§£æ JSON å¹¶å®é™…æ‰§è¡Œå·¥å…·çš„æ¨¡å—

---

## äºŒã€å·¥å…·å°è£…ä¸è§„èŒƒåŒ–è®¾è®¡

å¹¶éæ‰€æœ‰ä»£ç éƒ½é€‚åˆä½œä¸º Agent å·¥å…·ã€‚ä¼˜è´¨å·¥å…·å¿…é¡»éµå¾ª **åŸå­æ€§ï¼ˆAtomicityï¼‰** ä¸ **å¯ç†è§£æ€§ï¼ˆDescriptivenessï¼‰** åŸåˆ™ã€‚

### 2.1 å·¥å…·å°è£…æ ¸å¿ƒåŸåˆ™

1. **åŸå­æ€§ï¼ˆAtomicityï¼‰**

   * æ¯ä¸ªå·¥å…·å®Œæˆå•ä¸€ä»»åŠ¡

   * *ç¤ºä¾‹*ï¼š

     * é”™è¯¯ï¼š`ProcessDataAndSendEmail(data, recipient)`

     * æ­£ç¡®ï¼š`AnalyzeData(data)` ä¸ `SendEmail(recipient, content)`

2. **æè¿°æ€§ï¼ˆDescriptivenessï¼‰**

   * å·¥å…·åŠŸèƒ½æè¿°å¿…é¡»æ¸…æ™°ã€ç²¾ç¡®ã€å¯Œæœ‰ä¸Šä¸‹æ–‡

   * *Prompt ç¤ºä¾‹*ï¼š

     * é”™è¯¯ï¼š`tool_1: Search DB`

     * æ­£ç¡®ï¼š`tool_1: ä¸“ä¸šæ•°æ®åº“æŸ¥è¯¢å·¥å…·ï¼Œç”¨äºæ£€ç´¢å…¬å¸æœ€æ–°é”€å”®æ•°æ®ï¼Œå‚æ•°å¿…é¡»åŒ…å«æ—¶é—´èŒƒå›´å’Œäº§å“åç§°`

3. **æ˜ç¡®çš„è¾“å…¥/è¾“å‡º**

   * Observation åº”ä¸ºç»“æ„åŒ–æ•°æ®ï¼ˆJSON æˆ–ç®€æ´æ–‡æœ¬ï¼‰

   * é¿å…è¿”å›å†—é•¿éç»“æ„åŒ–æ—¥å¿—

### 2.2 å·¥å…·ä¸ RAG çš„é›†æˆ

* **RAG ä¹Ÿå¯ä½œä¸ºå·¥å…·**ï¼š`RetrieveKnowledge(query)`

* **åŠŸèƒ½**ï¼šè°ƒç”¨å‘é‡æ•°æ®åº“ï¼Œè¿”å›æœ€ç›¸å…³çš„ Top K è®°å¿†ç‰‡æ®µ

* **Agent ä½¿ç”¨åœºæ™¯**ï¼šå½“ LLM ç¼ºä¹äº‹å®ä¿¡æ¯æ—¶æ‰§è¡Œ Actionï¼Œè¡¥å…… Context

---

## ä¸‰ã€å·¥å…·ç³»ç»Ÿçš„å®‰å…¨ä¸æƒé™æ²»ç†

Agent å¯ä»¥æ‰§è¡Œæ•°æ®åº“å†™å…¥ã€æ–‡ä»¶æ“ä½œç­‰å®é™…è¡Œä¸ºï¼Œå®‰å…¨æ²»ç†æ˜¯è½åœ°ç”Ÿäº§çš„æœ€é«˜ä¼˜å…ˆçº§ã€‚

### 3.1 æƒé™åˆ†çº§ä¸æœ€å°æƒé™åŸåˆ™

* **æœ€å°æƒé™åŸåˆ™ï¼ˆPrinciple of Least Privilegeï¼‰**ï¼šAgent ä»…æ‹¥æœ‰å®Œæˆä»»åŠ¡æ‰€éœ€æƒé™

* **æƒé™éš”ç¦»**ï¼šä¸åŒ Agent å®ä¾‹ä½¿ç”¨ä¸åŒ API Keyï¼Œå·¥å…·é›†äº’ç›¸éš”ç¦»

### 3.2 æ²™ç®±æœºåˆ¶ä¸é£é™©éš”ç¦»

* **æ²™ç®±ï¼ˆSandboxï¼‰**ï¼šå¯¹æ‰§è¡Œä»£ç çš„å·¥å…·åœ¨éš”ç¦»ç¯å¢ƒï¼ˆå¦‚ Dockerï¼‰è¿è¡Œ

* **é«˜é£é™©æ“ä½œå®¡æ‰¹**ï¼šå…³é”®æ“ä½œå¦‚æ•°æ®åº“å†™å…¥éœ€ **Human-in-the-Loop** å®¡æ‰¹

> **ç¤ºä¾‹ Executor å®‰å…¨æ ¡éªŒä»£ç **

```python

def execute_tool(tool_name, args):

    if not current_agent.has_permission(tool_name):

        raise PermissionError(f"Agent lacks permission for {tool_name}")

    sanitized_args = sanitize(args)

    if tool_name == "SendEmail":

        result = send_email_service.dispatch(sanitized_args)

    return Observation(result)

```

---

## ğŸ” æ€»ç»“ï¼šå·¥å…·å†³å®š Agent çš„èƒ½åŠ›è¾¹ç•Œ

* **Plannerï¼ˆå¤§è„‘ï¼‰** å†³å®šæ™ºèƒ½ä¸Šé™

* **å·¥å…·é›†ï¼ˆæ‰‹è„šï¼‰** å†³å®šèƒ½åŠ›è¾¹ç•Œä¸å®ç”¨ä»·å€¼

é«˜æ•ˆã€å®‰å…¨çš„ Agent ç³»ç»Ÿä¾èµ–äº **Function Calling æœºåˆ¶ + åŸå­åŒ–å·¥å…· + æƒé™æ²»ç†**ï¼Œæ˜¯ Agent ä»"æ€è€ƒ"åˆ°"æ”¹å˜ä¸–ç•Œ"çš„å…³é”®ä¸€æ­¥ã€‚

---

## ğŸ“š çŸ¥è¯†æ¥æºä¸è¿›é˜¶é˜…è¯»ï¼ˆå¸¦é“¾æ¥ï¼‰

| ä¸»é¢˜                   | é“¾æ¥                                                                                         |
| -------------------- | ------------------------------------------------------------------------------------------ |
| **Function Calling** | [OpenAI Function Calling æ–‡æ¡£](https://platform.openai.com/docs/guides/gpt/function-calling) |
| **å·¥å…·è®¾è®¡åŸåˆ™**           | [Agent Tool Design Principles](https://www.langchain.com/docs/modules/agents/toolkits/)    |
| **Agent å®‰å…¨**         | [LLM Agent Security & Sandboxing](https://arxiv.org/abs/2305.17592)                        |
| **Executor å®ç°**      | [LangChain / LlamaIndex Executor æºç åˆ†æ](https://docs.langchain.com/docs/)                   |

---

## ğŸ”” ä¸‹ä¸€ç¯‡é¢„å‘Š

æˆ‘ä»¬å·²ä¸º Agent æ„å»ºå¤§è„‘ã€è®°å¿†å’Œæ‰‹è„šï¼Œä½†å…¶è¡Œä¸ºå¹¶éæ€»èƒ½å®‰å…¨å¯é ã€‚ä¸‹ä¸€ç¯‡å°†èšç„¦ **Agent çš„å®‰å…¨æ²»ç†**ï¼Œç¡®ä¿æƒé™ã€æ—¥å¿—å’Œå¯è§‚æµ‹æ€§æœºåˆ¶å®Œå¤‡ã€‚

**ç¬¬ 9 ç¯‡æ ‡é¢˜ï¼ˆæš‚å®šï¼‰ï¼š**

### ã€ŠAgent å®‰å…¨æ²»ç†ï¼šæƒé™ã€æ—¥å¿—ä¸å¯è§‚æµ‹æ€§ã€‹

