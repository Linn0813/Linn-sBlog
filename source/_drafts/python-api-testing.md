---
title: python_api_testing
tags:
  - æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•
  - python
categories: è‡ªåŠ¨åŒ–æµ‹è¯• & å·¥å…·å¼€å‘ï¼ˆTest Automation & Tool Developmentï¼‰
keywords: æ¥å£æµ‹è¯•
description: ç”¨pythonæ­å»ºæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°,
top_img: /img/python_api_testing_m.png
cover: /img/python_api_testing_s.png
date: 2025-03-24 13:34:42
updated: 2025-03-24 13:34:42
---

# **å¦‚ä½•ç”¨ Python æ­å»ºæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ŸğŸš€**

åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† **Postman** å’Œ **Apifox** è¿™ä¸¤ç§ API æµ‹è¯•å·¥å…·ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ¥å£æµ‹è¯•ï¼Œæä¾› **å¯è§†åŒ–ç•Œé¢ã€æ–­è¨€æ£€æŸ¥ã€è¯·æ±‚ç®¡ç†** ç­‰åŠŸèƒ½ï¼Œéå¸¸é€‚åˆæ‰‹å·¥æµ‹è¯•å’Œç®€å•çš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚

ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œè®¸å¤šæµ‹è¯•æµç¨‹éœ€è¦æ›´é«˜æ•ˆçš„ **è‡ªåŠ¨åŒ–æ‰§è¡Œ**ï¼Œä¾‹å¦‚ï¼š
- æ‰¹é‡è¿è¡Œæ¥å£æµ‹è¯•ï¼ˆä¸æƒ³æ‰‹åŠ¨ç‚¹æ¥ç‚¹å»ï¼‰
- é›†æˆåˆ° CI/CD æµç¨‹ï¼ˆæ¯æ¬¡ä»£ç æ›´æ–°è‡ªåŠ¨è·‘æµ‹è¯•ï¼‰
- æ»¡è¶³æ›´çµæ´»çš„å®šåˆ¶åŒ–éœ€æ±‚ï¼ˆå¦‚åŠ¨æ€å‚æ•°ã€æ•°æ®é©±åŠ¨ï¼‰

å› æ­¤ï¼Œåœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨ **Python** è¿›è¡Œæ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ğŸ’¡  
æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» **å¦‚ä½•ç”¨ Python æ­å»ºä¸€ä¸ªå¯æ‰©å±•çš„ API è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶**ï¼Œå¸®åŠ©ä½ ä»é›¶å¼€å§‹æŒæ¡è¿™é¡¹æŠ€èƒ½ï¼ğŸ”¥

---

## **ğŸ”¹ 1. ä¸ºä»€ä¹ˆé€‰æ‹© Python è¿›è¡Œæ¥å£æµ‹è¯•ï¼Ÿ**

### **âœ… Postman & Apifox vs Python**

| å·¥å…·       | é€‚åˆåœºæ™¯           | ä¸»è¦ä¼˜åŠ¿                     | å±€é™æ€§                   |
|------------|--------------------|------------------------------|--------------------------|
| **Postman**| æ‰‹å·¥æµ‹è¯•ã€ç®€å•è‡ªåŠ¨åŒ– | å¯è§†åŒ–æ“ä½œã€æ”¯æŒç¯å¢ƒå˜é‡       | å¤æ‚æµ‹è¯•ä¸æ–¹ä¾¿           |
| **Apifox** | æ¥å£æµ‹è¯•ã€æ–‡æ¡£ç®¡ç†   | ç»“åˆ API æ–‡æ¡£ & æµ‹è¯•           | éœ€è¦ GUIï¼Œä¸é€‚åˆ CI/CD    |
| **Python** | è‡ªåŠ¨åŒ–æµ‹è¯•ã€CI/CD    | çµæ´»å¼ºå¤§ã€å¯æ‰©å±•ã€æ”¯æŒæ•°æ®é©±åŠ¨ | éœ€è¦ç¼–å†™ä»£ç              |

å¦‚æœä½ æƒ³è®©æµ‹è¯•æ›´ **è‡ªåŠ¨åŒ–ã€å¯å®šåˆ¶ã€å¯æ‰©å±•**ï¼ŒPython ä¸€å®šæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼âœ…

---

## **ğŸ”¹ 2. æ­å»º Python æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•ç¯å¢ƒ**

### **ğŸ“Œ 2.1 å®‰è£… Python ä¾èµ–**
é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº† Pythonï¼ˆæ¨è Python 3.8+ï¼‰ã€‚  
ç„¶åï¼Œä½¿ç”¨ `pip` å®‰è£…éœ€è¦çš„åº“ï¼š
```bash
pip install requests pytest pytest-html
```

ğŸ“Œ **å·¥å…·ä»‹ç»ï¼š**
- **`requests`**ï¼šPython æœ€å¸¸ç”¨çš„ HTTP è¯·æ±‚åº“  
- **`pytest`**ï¼šè½»é‡çº§æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒæ–­è¨€å’Œå‚æ•°åŒ–  
- **`pytest-html`**ï¼šç”Ÿæˆ HTML æµ‹è¯•æŠ¥å‘Š

---

## **ğŸ”¹ 3. ç”¨ Python å‘é€ API è¯·æ±‚**

åœ¨æ­£å¼ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£å¦‚ä½•ç”¨ Python ç›´æ¥è¯·æ±‚ APIã€‚

### **ğŸ“Œ 3.1 å‘é€ GET è¯·æ±‚**
```python
import requests

url = "https://jsonplaceholder.typicode.com/posts/1"
response = requests.get(url)

print("çŠ¶æ€ç :", response.status_code)
print("è¿”å›æ•°æ®:", response.json())
```
âœ… è¿™æ®µä»£ç ä¼šè¯·æ±‚ä¸€ä¸ªæµ‹è¯• APIï¼Œå¹¶æ‰“å°è¿”å›çš„æ•°æ®ã€‚

### **ğŸ“Œ 3.2 å‘é€ POST è¯·æ±‚**
```python
import requests

data = {"title": "foo", "body": "bar", "userId": 1}
response = requests.post("https://jsonplaceholder.typicode.com/posts", json=data)

print("çŠ¶æ€ç :", response.status_code)
print("è¿”å›æ•°æ®:", response.json())
```
ğŸ’¡ è¿™é‡Œä½¿ç”¨ `json=data` æ¥å‘é€ JSON æ•°æ®ï¼Œé€‚ç”¨äºå¤§å¤šæ•° API æµ‹è¯•åœºæ™¯ã€‚

---

## **ğŸ”¹ 4. ç”¨ pytest ç¼–å†™æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•**

æˆ‘ä»¬å°†æŠŠ API è¯·æ±‚å°è£…åˆ°è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ä¸­ã€‚

### **ğŸ“Œ 4.1 åˆ›å»ºæµ‹è¯•æ–‡ä»¶ `test_api.py`**
```python
import requests

def test_get_post():
    url = "https://jsonplaceholder.typicode.com/posts/1"
    response = requests.get(url)

    # æµ‹è¯•æ–­è¨€ï¼šæ£€æŸ¥çŠ¶æ€ç å’Œè¿”å›æ•°æ®
    assert response.status_code == 200
    assert response.json()["id"] == 1
```
ğŸ“Œ ä½¿ç”¨ `assert` è¯­å¥éªŒè¯ API è¿”å›ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

### **ğŸ“Œ 4.2 è¿è¡Œæµ‹è¯•**
åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œæµ‹è¯•ï¼š
```bash
pytest test_api.py
```
å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ°æµ‹è¯•é€šè¿‡çš„æç¤ºï¼ğŸ‰

---

## **ğŸ”¹ 5. è¿›é˜¶ä¼˜åŒ–ï¼šå‚æ•°åŒ–æµ‹è¯• & æŠ¥å‘Šç”Ÿæˆ**

### **ğŸ“Œ 5.1 å‚æ•°åŒ–æµ‹è¯•å¤šä¸ªæ¥å£**
```python
import pytest
import requests

@pytest.mark.parametrize("post_id", [1, 2, 3, 4, 5])
def test_get_post(post_id):
    url = f"https://jsonplaceholder.typicode.com/posts/{post_id}"
    response = requests.get(url)

    assert response.status_code == 200
    assert response.json()["id"] == post_id
```
âœ… è¿™æ ·å¯ä»¥é¿å…é‡å¤ç¼–å†™ç±»ä¼¼çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæé«˜æµ‹è¯•æ•ˆç‡ï¼

### **ğŸ“Œ 5.2 ç”Ÿæˆ HTML æµ‹è¯•æŠ¥å‘Š**
```bash
pytest --html=report.html
```
ğŸ“Œ ç”Ÿæˆçš„ `report.html` æ–‡ä»¶å°†åŒ…å«æ‰€æœ‰æµ‹è¯•ç»“æœï¼Œæ–¹ä¾¿æŸ¥çœ‹å’Œå½’æ¡£ã€‚

---

## **ğŸ”¹ 6. æ„å»ºå¯æ‰©å±•çš„æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶**

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ„å»ºä¸€ä¸ª **å¯ç»´æŠ¤ã€å¯æ‰©å±•** çš„æµ‹è¯•æ¡†æ¶éå¸¸å…³é”®ã€‚

### **ğŸ“Œ 6.1 API è¯·æ±‚å°è£…**
```python
import requests

class APIClient:
    BASE_URL = "https://jsonplaceholder.typicode.com"

    @staticmethod
    def get_post(post_id):
        return requests.get(f"{APIClient.BASE_URL}/posts/{post_id}")

    @staticmethod
    def create_post(data):
        return requests.post(f"{APIClient.BASE_URL}/posts", json=data)
```

### **ğŸ“Œ 6.2 åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­è°ƒç”¨**
```python
from utils.api_client import APIClient

def test_get_post():
    response = APIClient.get_post(1)
    assert response.status_code == 200
```
âœ… è¿™æ ·å¯ä»¥è®©æµ‹è¯•ä»£ç æ›´æ¸…æ™°ä¸”æ˜“äºå¤ç”¨ã€‚

---

## **ğŸ”¹ 7. ç»“åˆ CI/CD å®ç°è‡ªåŠ¨åŒ–**

### **ğŸ“Œ ç¤ºä¾‹ GitHub Actions å·¥ä½œæµ (`ci.yml`)**
```yaml
name: API Test Automation

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Setup Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: pip install -r requirements.txt

      - name: Run API tests
        run: pytest --html=reports/report.html
```

---

## **ğŸ”¹ 8. ç»“è¯­**

ğŸ“Œ ç°åœ¨ï¼Œä½ å·²ç»æŒæ¡äº† **Python æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•** çš„åŸºæœ¬æŠ€èƒ½ï¼Œèµ¶ç´§å®è·µä¸€ä¸‹å§ï¼ğŸš€  
å¦‚æœè§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ **ç‚¹èµ & åˆ†äº«** å“¦ï¼ğŸ˜ƒ
